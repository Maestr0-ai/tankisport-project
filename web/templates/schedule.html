{% extends "base.html" %}
{% block content %}

<h1>Матчи</h1>

{% if matches %}
<div class="matches">
  {% for m in matches %}
  <div class="match-card" data-start="{{ m.time_iso }}">

    <div class="match-top">
      <span class="match-datetime">{{ m.time_display }}</span>

      {% if m.status == 1 %}
        <span class="live">
          <span class="live-dot"></span> LIVE
        </span>
      {% elif m.status == 0 %}
        <span class="countdown">⏳</span>
      {% else %}
        <span class="finished">Завершён</span>
      {% endif %}
    </div>

    <div class="match-row">
      <span class="team left">{{ m.team1 }}</span>
      <span class="vs">VS</span>
      <span class="team right">{{ m.team2 }}</span>
    </div>

  </div>
  {% endfor %}
</div>
{% else %}
<p>Матчей нет</p>
{% endif %}

<script>
function pad(n){return n.toString().padStart(2,"0");}

function updateTimers(){
  const now = new Date();
  document.querySelectorAll(".match-card").forEach(card=>{
    const start = new Date(card.dataset.start);
    const diff = start - now;
    const cd = card.querySelector(".countdown");
    if(cd && diff > 0){
      const h=Math.floor(diff/3600000);
      const m=Math.floor(diff%3600000/60000);
      const s=Math.floor(diff%60000/1000);
      cd.textContent = `⏳ ${pad(h)}:${pad(m)}:${pad(s)}`;
    }
  });
}
updateTimers();
setInterval(updateTimers,1000);
</script>

{% endblock %}
